name: TEST - Develop to test2 Workflow
on:
  push:
    branches: [ test ]
  pull_request:
    branches: [ test ]

jobs:
  push_to_test2_backend:
    runs-on: ubuntu-latest
    steps:
    # Se hace este checkout para que podamos encontrar los archivos que tenemos en develop
    - name: Checkout
      uses: actions/checkout@v3

    # - name: Check tests status
    #   run: python app/test_utils.py
    - name: Git set repo url
      run: git remote set-url origin https://github.com/Daga2001/SmartMarketPlace_backend/

    # Actualiza la rama local de test a la última versión remota
    # - name: Update test branch
    #   run: git pull origin test

    - name: Git create branch test2 locally
      run: git branch test2

    - name: Git checkout test2
      run: git checkout test2 

    - name: Git config username
      run: git config --global user.email '${{secrets.GIT_EMAIL}}'

    - name: Git config password
      run: git config --global user.name '${{secrets.GIT_NAME}}'

    - name: Update test2
      run: git pull origin test2 --rebase --strategy-option=theirs

    - name: Git merge with develop
      run: git rebase --strategy-option=theirs test

    - name: Git push 
      run: git push origin test2
  